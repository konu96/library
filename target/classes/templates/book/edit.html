<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	<head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous" />
    	<link rel="stylesheet" href="/css/style.css" type="text/css" />
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.0.2/vue.js" charset="utf-8"></script>
    	<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
	<script th:inline="javascript">
		/*<![CDATA[>*/
			$(function() {
				function categorize(books, name) {
					var result = [];
					for(var book in books) {
						if(books[book].genre.$name === name) {
							result.push(books[book]);
						}
					}
					
					return result;
				}
				var categories = []
				var genres = /*[[ ${genres} ]]*/ null;
				var books  = /*[[ ${books} ]]*/ null;
				for(var genre in genres) {
					categories.push( categorize(books, genres[genre].$name) );
				}
				
				for(var category in categories) {
					for(var id in categories[category]) {
						var html = '<a href="/books/' + books[id].id + '/" accept-charset="UTF-8" method="get"> <img src=' + books[id].imageUrl + ' width="200px" height="300px" alt="' + books[id].bookName + '" /> </a>';
						$('li[name="' + genres[category].$name + '"]').append(html);
					}
				}
			});
		/*]]>*/
	</script>
	<script th:inline="javascript" src="/js/index.js" />
  </head>
  <body>
  	<div class="box_wrapper">
  	  <header>
  	    <img src="/image/book_icon.png" width="55px" height="70px" style="float:left; margin-right: 10px;"/>
  	    <h1> <a href="/"> Library </a> </h1>
  	    <nav>
  	      <div class="entry">
  	        <ul>
  	          <li>
  	            <form action="/books/search" accept-charset="UTF-8" method="get">
  	              <input name="bookName" type="search" class="form-control form-control-sm bookName" placeholder="ğŸ”æœ¬ã®åå‰ã§æ¤œç´¢" />
  	            </form>
  	          </li>
  	          <block th:if="${loginUser == null}">
  	            <li>
  	              <form action="/login" accept-charset="UTF-8" method="get">
  	                <button class="btn btn-primary btn-lg active" aria-pressed="true" title="ãƒ­ã‚°ã‚¤ãƒ³" type="submit"> ãƒ­ã‚°ã‚¤ãƒ³ </button>
  	              </form> 
  	            </li>
  	            <li>
  	              <form action="/sign_up" accept-charset="UTF-8" method="get">
  	                <button class="btn btn-primary btn-lg active" aria-pressed="true" title="æ–°è¦ç™»éŒ²" type="submit"> æ–°è¦ç™»éŒ² </button>
  	              </form> 
  	            </li>
  	          </block>
  	          <block th:if="${loginUser != null}">
  	            <li>
  	              <form action="/books/insert" accept-charset="UTF-8" method="get">
  	                <button class="btn btn-primary btn-lg active" aria-pressed="true" title="è¿½åŠ " type="submit"> æœ¬ã‚’ç™»éŒ² </button>
                  </form>
  	              <form action="/logout" accept-charset="UTF-8" method="get">
  	                <button class="btn btn-primary btn-lg active" aria-pressed="true" title="ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ" type="submit"> ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ </button>
                  </form> 
                </li>
              </block>
            </ul>
          </div>
        </nav>
  	  </header>
  		<form th:action="@{'/books/' + ${book.id} + '/edit'}" th:object="${book}" accept-charset="UTF-8" method="post">
        			<p> æœ¬ã®åå‰ : <input type="text" th:field="*{bookName}" th:errorclass="error-field" value="*{bookName}" /> </p>
        			<p> è‘—è€…å : <input type="text" th:field="*{author}" th:errorclass="error-field" value="*{author}" /> </p>
        			<p> ç”»åƒURL : <input type="text" th:field="*{imageUrl}" th:errorclass="error-field" value="*{imageUrl}" /> </p>
        			<p> å†Šæ•° : <input type="number" name="number" value="1" th:errorclass="error-field" min="0" /> </p>
        			<button class="btn" type="submit"> é€ä¿¡ </button>
      	</form>
  		
  		<footer></footer>
  	</body>
</html>